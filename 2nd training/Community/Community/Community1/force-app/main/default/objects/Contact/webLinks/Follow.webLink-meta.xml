<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Follow</fullName>
    <availability>online</availability>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Follow</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/18.0/connection.js&quot;)} 

//EDIT THE FOLLOWING LINE TO ALTER THE CODE FOR OTHER OBJECTS.  USE THE PICKLISTS ABOVE TO SELECT FIELD TYPE = $ObjectType AND THE OBJECT NAME THEN REPLACE &quot;$ObjectType.Contact&quot; WITH YOUR NEW OBJECT NAME
var records = {!GETRECORDIDS( $ObjectType.Contact)};

function LBox() {
             var box = new parent.SimpleDialog(&quot;steve&quot;+Math.random(), true);
             parent.box = box;
        
             box.setTitle(&quot;Follow Records&quot;);
        
             box.createDialog();
             box.setWidth(220);
             
             box.setContentInnerHTML(&quot;&lt;img src=&apos;/img/loading32.gif&apos; alt=&apos;&apos; /&gt; Running&quot;);

             box.setupDefaultButtons();
             
             box.show();
}

function CBox(){
     box.setContentInnerHTML(&quot;You are now following &quot;+follow_count+&quot; records&lt;br /&gt;&lt;br /&gt;&lt;a href=\&quot;#\&quot; onclick=\&quot;box.hide();\&quot;&gt;Close&lt;/a&gt;&quot;);
}



if (records[0] == null) { 
   alert(&quot;Please select at least one record.&quot;);
} 
else { 
   var follow_count = 0;
   
   LBox();

   for (var i = 0; i &lt; records.length; i++){ 
        var fol=new sforce.SObject(&quot;EntitySubscription&quot;);
        fol.ParentId = records[i];
        fol.SubscriberId = &apos;{!User.Id}&apos;;
        
        try{
           sforce.connection.create([fol]); 
           follow_count++;
         }
        catch(e){
             alert(e);
         }
   }
   CBox();

}</url>
</WebLink>
