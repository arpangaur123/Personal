<html>
<!--
Generated by AJAX tools
Date     :  Fri May 04 2007 15:35:42 GMT+0800 (Malay Peninsula Standard Time)
Template :  simple.html by manoj@cheenath.com
SControl   :  ajax_tools_simple
 -->
<head>
<script src="/soap/ajax/9.0/connection.js"></script>
<script>

	function setupPage(){
		
		var state = {
			output: document.getElementById("output"),
			startTime: new Date().getTime()
		}; 

		var callback = {
			onSuccess: layoutResults,
			onFailure: queryFailed, source: state
		};

		sforce.connection.query("Select Id, Name, Email From User",callback);
		
	}

	function queryFailed(error, source){
		source.output.innerHTML = "An error has occured: " + error;
	}


	function layoutResults(queryResult,source) {
		if (queryResult.size > 0) {
			var output = "";
			var records = queryResult.getArray('records');
			
			output += "<table border=1>";
			
			for (var i = 0; i < records.length; i++) {
				var account = records[i];
				output += "<tr>";
				output += "<td>" + account.Id + "</td>";
				output += "<td>" + account.Name + "</td>";
				output += "<td>" + account.Email + "</td>";
				output += "</tr>";
			}
			output += "</table>";
		}
		source.output.innerHTML = output;
	}
</script>
</head>
<body onload="setupPage();">
  <div id="output"></div>
</body>
</html>